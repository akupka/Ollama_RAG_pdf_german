Spezifikation Verzeichnisdienst
Der Anbieter des VZD MUSS sich über einen organisatorischen Prozess bei einem
vertrauenswürdigen Identity Provider (IDP) der Telematikinfrastruktur als Relying Party
registrieren und die Bereitstellung der folgenden Claims in für Nutzer ausgestellte
ACCESS_TOKEN mit dem IDP vereinbaren:
• name
• sub
• scope
• acr
damit der VZD die Fachlogik der Autorisierung und Protokollierung auf diesen Attributen
umsetzen kann.
[<=]
A_20268 - VZD, Authentifizierung Nutzerrolle
Der VZD MUSS die fachliche Rolle eines Nutzers in jedem Operationsaufruf der
Schnittstelle I_Directory_Administration anhand des Attributs "scope" im übergebenen
ACCESS_TOKEN feststellen und für die nachfolgende Rollenprüfung je Operationsaufruf
verwenden. [<=]
A_20269 - VZD, Authentifizierung Nutzername
Der VZD MUSS den Namen eines Nutzers in jedem Operationsaufruf anhand des Attributs
"name" im übergebenen ACCESS_TOKEN feststellen und für die Protokollierung des
Zugriffs verwenden. [<=]
A_18470 - VZD, I_Directory_Administration, Client Secret Qualität
Der VZD-Anbieter MUSS bei der Erzeugung der OAuth client_secret‘s 128 Bit Zufall aus
einer Zufallsquelle gemäß GS-A_4367 [gemSpec_Krypt] verwenden.
[<=]
A_18409 - VZD, I_Directory_Administration, Sperrung OAuth Client Credentials
Der VZD-Anbieter MUSS – für die gematik und den Client-Betreiber selbst - einen Service
zur Sperrung der OAuth Client Credentials anbieten.
[<=]
A_18372 - VZD, I_Directory_Administration, TLS-gesicherte Verbindung
Der VZD MUSS die Schnittstelle I_Directory_Administration durch Verwendung von TLS
mit serverseitiger Authentisierung sichern.
Der VZD MUSS für diese TLS-Verbindungen öffentliche Zertifikate nutzen (keine TI-
Zertifikate).
Der VZD MUSS sich mit der Server-Identität von Schnittstelle I_Directory_Administration
authentisieren.
[<=]
Die Prüfung der öffentliche TLS-Server Zertifikate muss gemäß GS-A_5581
[gemSpec_Krypt] erfolgen. Dabei müssen in (1) von GS-A_5581 statt der
"Komponenten-CA-Zertifikate der TI" die CA-Zertifikate der Schnittstelle
I_Directory_Administration genutzt werden.
A_18374 - VZD, I_Directory_Administration, Redirect
Der VZD MUSS für die Schnittstelle I_Directory_Administration Anfragen der Clients –
welche kein AccessToken entsprechend [ RFC 6750] enthalten – durch ein Redirect zu
dem OAuth2-Authentifizierungsdienst weiterleiten. [<=]
A_18375 - VZD, I_Directory_Administration, OAuth2 Dienst
Der VZD MUSS einen OAuth2-Dienst bereitstellen. Dieser Dienst MUSS die Clients der
Schnittstelle I_Directory_Administration anhand ihrer Client Credentials authentisieren
und ihnen ein AccessToken entsprechend [ RFC 6750] ausstellen. Das AccessToken muss
gemSpec_VZD_V1.docx Spezifikation Seite 44 von 72
Version: 1.14.0 © gematik – öffentlich Stand: 31.01.2022